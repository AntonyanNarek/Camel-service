# Camel-service

Целью задания является погружение в apache camel. В работе использованы spring'овые стартеры для camel.
Приложение создает 2 rest-сервиса.
Первый на вход получает dto с датой.
При поступлении запроса в сервис, он отправляет в топик kafka сообщение в protobuf формате, в котором будет информация о том, когда запрос пришел и от кого (ip) и какая дата пришла в запросе, guid запроса. В ответ возвращается guid запроса, который мы положили в kafka.
Далее, после вычитки из топика, сервис дзаписывает в БД в таблицу sessions данные, которые пришли.
Второй сервис на вход принимает guid (результат выполнения первого сервиса). Далее соединяется с СУБД, выбирает по guid данные из таблицы sessions. Если данных нет, возвращает ответ о том, что данных нет.
Если есть, производит select из таблицы trains с данными с учетом даты из sessions (тело запроса первого сервиса).
Структура таблицы такая: id_train integer, dt_start datetime, id_station_start integer, train_name varchar.
Сортировка запроса должна быть по dt_start.
Запрос выбирает значения, где dt_start > присланной даты из sessions (тело запроса первого сервиса).
Получив данные из СУБД, они обрабатываются в camel в 5 потоков. Каждый поток получает одну запись, полученную из БД, и делает так, чтобы train_name становился UPPER_CASE.
После этого они возвращаются в качестве ответа на изначальный запрос вызывающему.
Rest-сервисы, работа с kafka и СУБД, многопоточка реализованы именно на camel. В качестве СУБД использован PG.
